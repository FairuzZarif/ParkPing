<div class="border-token-border-sharp dark:border-token-main-surface-secondary @container relative mx-[-16px] mb-4 flex cursor-text flex-col items-start overflow-hidden rounded-[14px] border p-4 shadow-md contain-inline-size sm:mx-[-32px] sm:rounded-[28px] sm:p-8"><div class="flex w-full items-center justify-between gap-2"><div class="text-token-text-tertiary flex items-center gap-2"><p>ParkPing Project Starter Package with UI, Flask Backend, SQLite, and Google Maps</p></div><div class="hover:bg-token-main-surface-secondary cursor-pointer rounded-md p-2"></div></div><div data-message-author-role="assistant" data-message-id="27083708-999b-4fa3-85a3-7ddbcb777904" dir="auto" class="min-h-8 text-message relative flex w-full flex-col items-end gap-2 text-start break-words whitespace-normal [.text-message+&amp;]:mt-5"><div class="flex w-full flex-col gap-1 empty:hidden first:pt-[3px]"><div class="markdown prose dark:prose-invert w-full break-words light deep-research-result"><h1 data-start="0" data-end="62" class="">ParkPing – Real-Time Street Parking Alerts (Starter Project)</h1>
<h2 data-start="64" data-end="75" class="">Overview</h2>
<p data-start="77" data-end="476" class=""><strong data-start="77" data-end="89">ParkPing</strong> is a developer-friendly starter project for a real-time street parking alert platform. It provides a complete, responsive web application that lets users find and book nearby parking spots in real time. The project is structured with a <strong data-start="326" data-end="341">Bootstrap 5</strong> front-end (styled similar to Uber/Uber Eats flows) and a <strong data-start="399" data-end="408">Flask</strong> back-end, using <strong data-start="425" data-end="435">SQLite</strong> for data storage. Key features include:</p>
<ul data-start="478" data-end="1253">
<li data-start="478" data-end="607" class="">
<p data-start="480" data-end="607" class=""><strong data-start="480" data-end="497">Responsive UI</strong> – A mobile-friendly interface with a source/destination input and a live Google Map for nearby parking spots.</p>
</li>
<li data-start="608" data-end="727" class="">
<p data-start="610" data-end="727" class=""><strong data-start="610" data-end="637">Google Maps Integration</strong> – Displays the user’s current location and available parking spots on an interactive map.</p>
</li>
<li data-start="728" data-end="829" class="">
<p data-start="730" data-end="829" class=""><strong data-start="730" data-end="747">User Accounts</strong> – Registration and login system backed by SQLite (passwords hashed for security).</p>
</li>
<li data-start="830" data-end="957" class="">
<p data-start="832" data-end="957" class=""><strong data-start="832" data-end="858">Booking &amp; Payment Flow</strong> – Users can reserve a parking spot, see cost calculated per hour, and simulate payment completion.</p>
</li>
<li data-start="958" data-end="1111" class="">
<p data-start="960" data-end="1111" class=""><strong data-start="960" data-end="977">Notifications</strong> – Popup alerts (and placeholders for email notifications) inform users of important events (e.g., spot booked, payment confirmation).</p>
</li>
<li data-start="1112" data-end="1253" class="">
<p data-start="1114" data-end="1253" class=""><strong data-start="1114" data-end="1139">Scalable Architecture</strong> – Flask REST API organized in a microservices-style layout for auth, parking, and payment logic, ready to expand.</p>
</li>
</ul>
<h2 data-start="1255" data-end="1266" class="">Features</h2>
<ul data-start="1268" data-end="3378">
<li data-start="1268" data-end="1536" class="">
<p data-start="1270" data-end="1536" class=""><strong data-start="1270" data-end="1288">Uber-Style UI:</strong> The interface follows a familiar ride-hailing layout with an address input (destination) and a map. Users can input a destination and see parking spots near that location. The design uses Bootstrap for a clean, modern look and is fully responsive.</p>
</li>
<li data-start="1537" data-end="1833" class="">
<p data-start="1539" data-end="1833" class=""><strong data-start="1539" data-end="1565">Real-Time Map Updates:</strong> The app uses the Google Maps JavaScript API to show available parking spots around the user. A marker indicates the user’s current position and other markers show free parking spots. The map auto-centers on the user’s location (if permitted) or a default city center.</p>
</li>
<li data-start="1834" data-end="2059" class="">
<p data-start="1836" data-end="2059" class=""><strong data-start="1836" data-end="1866">User Registration &amp; Login:</strong> Visitors can create an account and login. Authentication is handled via Flask sessions. All user info is stored in a local SQLite database. Passwords are stored securely (hashed via Werkzeug).</p>
</li>
<li data-start="2060" data-end="2354" class="">
<p data-start="2062" data-end="2354" class=""><strong data-start="2062" data-end="2090">Parking Spot Management:</strong> The back-end defines a simple model for parking spots (with fields like address, coordinates, hourly rate, and availability). Some sample spots are pre-loaded for demonstration. Users can fetch available spots and book them, which flips their availability status.</p>
</li>
<li data-start="2355" data-end="2752" class="">
<p data-start="2357" data-end="2752" class=""><strong data-start="2357" data-end="2397">Booking Confirmation &amp; Mock Payment:</strong> When a user books a spot, they specify the duration (hours) and the cost is calculated (rate × hours). The booking is recorded in the database and the spot is marked as unavailable. Users are then prompted to “pay” – the payment is simulated by an API call that marks the booking as paid. This flow mimics a real booking confirmation and payment process.</p>
</li>
<li data-start="2753" data-end="3378" class="">
<p data-start="2755" data-end="3378" class=""><strong data-start="2755" data-end="2773">Notifications:</strong> The front-end provides feedback via alerts/confirmation dialogs for actions like successful booking or payment. The project is set up to easily integrate more advanced notifications (e.g., Bootstrap toasts for non-intrusive alerts – <em data-start="3007" data-end="3089">“Toasts are lightweight notifications designed to mimic the push notifications…”</em><span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://getbootstrap.com/docs/5.0/components/toasts/#:~:text=Toasts%20are%20lightweight%20notifications%20designed,mobile%20and%20desktop%20operating%20systems" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">getbootstrap.com</span></span></span></a></span>). The back-end also includes a placeholder print statement to simulate sending an email confirmation, indicating where an email API or SMTP call would occur (<em data-start="3285" data-end="3376">Python’s built-in <code data-start="3304" data-end="3313">smtplib</code> can send emails via SMTP<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://realpython.com/python-send-email/#:~:text=Python%20comes%20with%20the%20built,the%20same%20principles%20apply%20to" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">realpython.com</span></span></span></a></span></em>).</p>
</li>
</ul>
<h2 data-start="3380" data-end="3403" class="">Project Architecture</h2>
<p data-start="3405" data-end="4154" class="">This starter project is split into <strong data-start="3440" data-end="3453">front-end</strong> and <strong data-start="3458" data-end="3470">back-end</strong> components, organized for clarity and scalability. The Flask back-end uses Blueprints (modular route groupings) to simulate a microservices architecture: there are separate blueprint modules for authentication, parking, and payments. This keeps the code organized by concern, which is important as the application grows<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://www.digitalocean.com/community/tutorials/how-to-structure-a-large-flask-application-with-flask-blueprints-and-flask-sqlalchemy#:~:text=Flask%20provides%20a%20way%20to,organized%20application" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">digitalocean.com</span></span></span></a></span><span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://www.digitalocean.com/community/tutorials/how-to-structure-a-large-flask-application-with-flask-blueprints-and-flask-sqlalchemy#:~:text=For%20example%2C%20in%20a%20social,Each%20part%20of%20the%20application" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">digitalocean.com</span></span></span></a></span>. In a larger project, each module could even become an independent service. Flask’s blueprint system helps achieve this separation of concerns (<em data-start="4009" data-end="4152">Flask provides a feature called blueprints to organize your application into components for each feature<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://www.digitalocean.com/community/tutorials/how-to-structure-a-large-flask-application-with-flask-blueprints-and-flask-sqlalchemy#:~:text=Flask%20provides%20a%20feature%20called,so%20on%20for%20each%20feature" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">digitalocean.com</span></span></span></a></span></em>).</p>
<p data-start="4156" data-end="4178" class=""><strong data-start="4156" data-end="4178">Project structure:</strong></p>
<pre class="overflow-visible!" data-start="4180" data-end="4502"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">plaintext</div><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-plaintext"><span><span>ParkPing/
├── backend/
│   └── app.py            &lt;- Flask app with REST API (auth, parking, payment)
├── frontend/
│   ├── templates/        &lt;- HTML files (index, login, register)
│   └── static/           &lt;- Static assets (JavaScript, CSS)
└── ParkPingStarter.zip   &lt;- Packaged project zip (for download)
</span></span></code></div></div></pre>
<ul data-start="4504" data-end="6149">
<li data-start="4504" data-end="4988" class="">
<p data-start="4506" data-end="4988" class=""><strong data-start="4506" data-end="4520">Front-end:</strong> Built with HTML5 and Bootstrap 5 (no Tailwind). The front-end is a single-page app for logged-in users (<code data-start="4625" data-end="4637">index.html</code>) plus separate pages for login and registration. It communicates with the Flask API via AJAX (Fetch API calls in <code data-start="4751" data-end="4759">lib.js</code>). The UI layout uses a Bootstrap navbar (with the app brand and a logout button) and a search bar for destination input. Below that is a full-width map. The design is mobile-responsive using Bootstrap’s grid and utility classes.</p>
</li>
<li data-start="4989" data-end="5511" class="">
<p data-start="4991" data-end="5511" class=""><strong data-start="4991" data-end="5004">Back-end:</strong> A Flask application (<code data-start="5026" data-end="5034">app.py</code>) provides RESTful endpoints under an <code data-start="5072" data-end="5080">/api/*</code> namespace. It uses Flask’s session for user login state and SQLite for persistent storage. The code is organized into logical sections (or Blueprints) for different domains (Auth, Parking, Payment), which makes the app easier to maintain and extend<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://www.digitalocean.com/community/tutorials/how-to-structure-a-large-flask-application-with-flask-blueprints-and-flask-sqlalchemy#:~:text=For%20example%2C%20in%20a%20social,Each%20part%20of%20the%20application" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">digitalocean.com</span></span></span></a></span>. For simplicity, all back-end code resides in one file in this starter, but it’s structured with clear separation of functions for each feature.</p>
</li>
<li data-start="5512" data-end="6149" class="">
<p data-start="5514" data-end="6149" class=""><strong data-start="5514" data-end="5527">Database:</strong> SQLite is chosen for its zero-configuration nature. The schema has three tables: <strong data-start="5609" data-end="5618">users</strong> (for login credentials), <strong data-start="5644" data-end="5661">parking_spots</strong> (for spot info and availability), and <strong data-start="5700" data-end="5712">bookings</strong> (to track reservations, times, and payment status). The Flask app uses a lightweight approach to database connections, opening a connection when needed and ensuring it’s closed after each request (<em data-start="5910" data-end="6019">using Flask’s application context <code data-start="5945" data-end="5948">g</code> to hold a connection per request<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://flask.palletsprojects.com/en/stable/patterns/sqlite3/#:~:text=def%20get_db,connect%28DATABASE%29%20return%20db" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">flask.palletsprojects.com</span></span></span></a></span></em>). On startup, the app initializes the database schema if not already present, and inserts a few sample parking spots for testing.</p>
</li>
</ul>
<h2 data-start="6151" data-end="6192" class="">Frontend: UI &amp; Google Maps Integration</h2>
<p data-start="6194" data-end="6407" class="">The front-end uses <strong data-start="6213" data-end="6228">Bootstrap 5</strong> for styling, ensuring the app looks good on desktop and mobile. The layout resembles Uber’s approach: a top bar for navigation and input, and the main area dedicated to the map.</p>
<ul data-start="6409" data-end="9374">
<li data-start="6409" data-end="7002" class="">
<p data-start="6411" data-end="7002" class=""><strong data-start="6411" data-end="6427">Map Display:</strong> The app integrates Google Maps via the Maps JavaScript API. In the HTML, a script tag loads the Google Maps API with a callback to <code data-start="6559" data-end="6568">initMap</code>. (You must obtain a Google Maps API key and enable the Maps JS API to use this – <em data-start="6650" data-end="6767">Google’s documentation explains how to get an API key via Google Cloud Console<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://developers.google.com/maps/documentation/javascript/adding-a-google-map#:~:text=Step%201%3A%20Get%20an%20API,key" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">developers.google.com</span></span></span></a></span></em>). When the API script loads, it calls the <code data-start="6810" data-end="6821">initMap()</code> function defined in our <code data-start="6846" data-end="6854">lib.js</code>. This function creates a new map centered on a default location and then tries to get the user’s actual location via the browser’s Geolocation API.</p>
</li>
<li data-start="7004" data-end="7683" class="">
<p data-start="7006" data-end="7683" class=""><strong data-start="7006" data-end="7022">Geolocation:</strong> If the user grants permission, the app uses <code data-start="7067" data-end="7109">navigator.geolocation.getCurrentPosition</code> to get the device’s latitude/longitude and recenters the map there, placing a special marker (“You are here”) to denote the user’s position. (Note: For security, many browsers require that geolocation is used only on secure contexts – e.g., https or localhost – otherwise it may fail<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://stackoverflow.com/questions/42986066/how-to-add-a-marker-to-google-map-of-users-location#:~:text=" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">stackoverflow.com</span></span></span></a></span>. When developing, run the app on <code data-start="7464" data-end="7482">http://localhost</code> or consider enabling HTTPS for testing to allow geolocation). If geolocation is unavailable or denied, the map stays at the default center (configurable; in this starter, it’s set to a downtown area).</p>
</li>
<li data-start="7685" data-end="8128" class="">
<p data-start="7687" data-end="8128" class=""><strong data-start="7687" data-end="7707">Parking Markers:</strong> After initializing the map, the front-end script fetches the list of available parking spots from the back-end (<code data-start="7820" data-end="7844">GET /api/parking/spots</code>). For each spot returned, a Google Maps Marker is placed on the map. Clicking a parking spot marker opens an info window showing the spot’s address and hourly rate, along with a “Book this spot” button. This provides a real-time visualization of parking availability around the user.</p>
</li>
<li data-start="8130" data-end="8958" class="">
<p data-start="8132" data-end="8958" class=""><strong data-start="8132" data-end="8155">Destination Search:</strong> The UI includes a destination search field. A user can enter an address (e.g., their destination), and on clicking "Find Parking", the app will geocode the address using Google’s Geocoding service (available via the Maps API). If found, the map centers on that location and drops a “destination” marker (blue pin) to mark it. Currently, all parking spots are still shown (the example back-end does not yet filter spots by proximity to the destination), but this feature sets the stage for adding such filtering or even integrating Google Maps Directions in the future. <em data-start="8725" data-end="8958">(Creating a map with a marker involves obtaining an API key, an HTML container, and adding the map via JavaScript<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://developers.google.com/maps/documentation/javascript/adding-a-google-map#:~:text=There%20are%20three%20steps%20to,marker%20on%20your%20web%20page" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">developers.google.com</span></span></span></a></span> – which our project handles through the included script and <code data-start="8937" data-end="8946">initMap</code> function.)</em></p>
</li>
<li data-start="8960" data-end="9374" class="">
<p data-start="8962" data-end="9374" class=""><strong data-start="8962" data-end="8984">Responsive Design:</strong> Thanks to Bootstrap, the layout adjusts to different screen sizes. The map container uses a flexible height (75vh – 75% of the viewport height) to ensure it’s visible without scrolling on most devices. The input and buttons stack on smaller screens. The use of Bootstrap’s classes (like grid columns, <code data-start="9286" data-end="9292">.btn</code>, <code data-start="9294" data-end="9309">.form-control</code>, etc.) means the UI is immediately usable on phones and tablets.</p>
</li>
</ul>
<h2 data-start="9376" data-end="9415" class="">Backend: Flask API &amp; SQLite Database</h2>
<p data-start="9417" data-end="9818" class="">The back-end is a <strong data-start="9435" data-end="9444">Flask</strong> application (<code data-start="9458" data-end="9466">app.py</code>) that serves both the front-end pages and the JSON APIs. It’s configured to serve the HTML from a <code data-start="9565" data-end="9576">templates</code> folder and static files (JS/CSS) from a <code data-start="9617" data-end="9625">static</code> folder. When the Flask server is running, navigating to the root (<code data-start="9692" data-end="9695">/</code>) will render <code data-start="9709" data-end="9721">index.html</code> if the user is logged in (determined by a session cookie), or redirect to the login page if not.</p>
<p data-start="9820" data-end="9856" class=""><strong data-start="9820" data-end="9856">Key Flask components and routes:</strong></p>
<ul data-start="9858" data-end="14502">
<li data-start="9858" data-end="10362" class="">
<p data-start="9860" data-end="10362" class=""><strong data-start="9860" data-end="9886">Application Structure:</strong> We use a single Flask app with multiple route groupings. In a larger application, we would use Flask Blueprints to organize routes by module (auth, parking, etc.). In this starter, for simplicity, the routes are defined in one file but logically separated by feature (comments and ordering). This modular approach makes the code easier to navigate and scale; each part of the app (auth, parking, payment) can be understood in isolation<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://www.digitalocean.com/community/tutorials/how-to-structure-a-large-flask-application-with-flask-blueprints-and-flask-sqlalchemy#:~:text=Flask%20provides%20a%20way%20to,organized%20application" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">digitalocean.com</span></span></span></a></span>.</p>
</li>
<li data-start="10364" data-end="10917" class="">
<p data-start="10366" data-end="10917" class=""><strong data-start="10366" data-end="10390">Database Connection:</strong> The app uses a simple pattern to handle the SQLite database: a <code data-start="10454" data-end="10464">get_db()</code> function opens a connection (stored in Flask’s <code data-start="10512" data-end="10515">g</code> object) on first use per request, and a <code data-start="10556" data-end="10577">teardown_appcontext</code> closes it after the request ends<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://flask.palletsprojects.com/en/stable/patterns/sqlite3/#:~:text=def%20get_db,connect%28DATABASE%29%20return%20db" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">flask.palletsprojects.com</span></span></span></a></span>. This pattern avoids having to open/close connections manually in every route. The database file is <code data-start="10750" data-end="10763">parkping.db</code> (automatically created in the project directory). The schema is set up in <code data-start="10838" data-end="10849">init_db()</code> which is called at startup – it creates tables if they don’t exist.</p>
</li>
<li data-start="10919" data-end="11602" class="">
<p data-start="10921" data-end="10961" class=""><strong data-start="10921" data-end="10937">Data Models:</strong> There are three tables:</p>
<ul data-start="10964" data-end="11602">
<li data-start="10964" data-end="11087" class="">
<p data-start="10966" data-end="11087" class=""><strong data-start="10966" data-end="10976">users:</strong> (id, email, password) – stores user credentials. The password is hashed for security using Werkzeug’s utility.</p>
</li>
<li data-start="11090" data-end="11356" class="">
<p data-start="11092" data-end="11356" class=""><strong data-start="11092" data-end="11110">parking_spots:</strong> (id, address, lat, lng, rate, is_available) – stores parking spot info. In a real app, this might be populated via sensors or an admin interface; here we seed a few rows for demo. <code data-start="11291" data-end="11305">is_available</code> is a boolean (1/0) indicating if the spot is free.</p>
</li>
<li data-start="11359" data-end="11602" class="">
<p data-start="11361" data-end="11602" class=""><strong data-start="11361" data-end="11374">bookings:</strong> (id, user_id, spot_id, start_time, end_time, cost, paid) – records each booking/reservation. It tracks which user booked which spot, the start/end times of the reservation, the calculated cost, and whether payment is completed.</p>
</li>
</ul>
</li>
<li data-start="11604" data-end="12394" class="">
<p data-start="11606" data-end="11627" class=""><strong data-start="11606" data-end="11625">Auth Endpoints:</strong></p>
<ul data-start="11630" data-end="12394">
<li data-start="11630" data-end="11939" class="">
<p data-start="11632" data-end="11939" class=""><code data-start="11632" data-end="11657">POST /api/auth/register</code> – accepts JSON with email &amp; password. Creates a new user account (after hashing the password). If the email already exists, it returns an error. On success, returns a JSON message. (In a production system, you’d likely also validate the email format and enforce password strength.)</p>
</li>
<li data-start="11942" data-end="12321" class="">
<p data-start="11944" data-end="12321" class=""><code data-start="11944" data-end="11966">POST /api/auth/login</code> – accepts JSON credentials, verifies the user (checking the hashed password). On success, it uses Flask’s session to store the user’s ID (logged-in state) and returns a success message. On failure, returns an error JSON. The session approach means subsequent requests from the same client will remain authenticated (session cookie is sent automatically).</p>
</li>
<li data-start="12324" data-end="12394" class="">
<p data-start="12326" data-end="12394" class=""><code data-start="12326" data-end="12349">POST /api/auth/logout</code> – logs the user out by clearing the session.</p>
</li>
</ul>
</li>
<li data-start="12396" data-end="13843" class="">
<p data-start="12398" data-end="12422" class=""><strong data-start="12398" data-end="12420">Parking Endpoints:</strong></p>
<ul data-start="12425" data-end="13635">
<li data-start="12425" data-end="12814" class="">
<p data-start="12427" data-end="12814" class=""><code data-start="12427" data-end="12451">GET /api/parking/spots</code> – returns a JSON list of all currently available parking spots. This route is protected (requires login; it checks for <code data-start="12571" data-end="12580">user_id</code> in session). The response format is <code data-start="12617" data-end="12670">{ "spots": [ {id, address, lat, lng, rate}, ... ] }</code>. The front-end uses this to plot markers on the map. (In a real scenario, this could accept query parameters for filtering by location/radius).</p>
</li>
<li data-start="12817" data-end="13635" class="">
<p data-start="12819" data-end="13635" class=""><code data-start="12819" data-end="12843">POST /api/parking/book</code> – used to book/reserve a parking spot. Expects JSON like <code data-start="12901" data-end="12941">{ "spot_id": &lt;ID&gt;, "hours": &lt;number&gt; }</code>. This is also protected (requires login). The route checks the requested spot in the database: if it’s available, it calculates the cost (<code data-start="13080" data-end="13094">rate * hours</code>), marks the spot as unavailable, and creates a booking entry with start time = now and end time = now + given hours. The <code data-start="13216" data-end="13222">paid</code> flag in the booking starts as 0 (not paid yet). The API responds with the booking ID and cost (JSON). If the spot was already taken or any error occurs, an error JSON is returned. After booking, the server prints a notification message to the console as a placeholder for sending an email notification (e.g., “Confirmation email sent to user”) – this is where you could integrate an email service in the future.</p>
</li>
</ul>
<p data-start="13639" data-end="13843" class=""><em data-start="13639" data-end="13843">(The booking flow simulates reserving a spot in real-time. The cost calculation is straightforward in this demo, but it could be extended (e.g., different rates for different spots or dynamic pricing).)</em></p>
</li>
<li data-start="13845" data-end="14502" class="">
<p data-start="13847" data-end="13870" class=""><strong data-start="13847" data-end="13868">Payment Endpoint:</strong></p>
<ul data-start="13873" data-end="14502">
<li data-start="13873" data-end="14502" class="">
<p data-start="13875" data-end="14502" class=""><code data-start="13875" data-end="13903">POST /api/payment/complete</code> – simulates completing a payment for a booking. Expects JSON <code data-start="13965" data-end="13989">{ "booking_id": &lt;ID&gt; }</code> and requires login. It checks that the booking exists and belongs to the current user, and that it isn’t already paid. Then it updates the booking’s <code data-start="14139" data-end="14145">paid</code> status to 1 (paid). In a real application, this is where integration with a payment gateway (Stripe, PayPal, etc.) would happen. Here we just assume payment is successful and return a confirmation JSON. (The spot remains marked as unavailable; one could add logic to automatically free the spot after the end time or allow the user to manually release it.)</p>
</li>
</ul>
</li>
</ul>
<p data-start="14504" data-end="14699" class="">All API responses are JSON for easy consumption by the front-end. HTTP status codes are used to indicate success (200 OK or 201 Created) or errors (400 for bad input, 401 for unauthorized, etc.).</p>
<p data-start="14701" data-end="15156" class=""><strong data-start="14701" data-end="14720">Security Notes:</strong> This starter uses basic session-based auth (Flask’s signed cookie). It’s sufficient for a demo, but for production you’d ensure to use HTTPS to protect session cookies, possibly implement token-based auth for a more decoupled client, and handle password reset flows, etc. The password hashing uses Werkzeug’s safe hash (PBKDF2 by default) which is a solid start; in a real project you might choose an even stronger hashing like bcrypt.</p>
<h2 data-start="15158" data-end="15183" class="">Notifications &amp; Alerts</h2>
<p data-start="15185" data-end="15634" class="">Currently, user-facing notifications are implemented with simple JavaScript alerts and <code data-start="15272" data-end="15281">confirm</code> dialogs. For example, after booking a spot, the front-end will <code data-start="15345" data-end="15356">confirm()</code> with the calculated cost asking the user to proceed with payment. Alerts are used to show error messages (e.g., if booking fails or payment error) or success confirmation (payment success). This approach makes it clear when an action occurs, but it’s blocking and not stylized.</p>
<p data-start="15636" data-end="16136" class="">As an enhancement, the project could use <strong data-start="15677" data-end="15697">Bootstrap Toasts</strong> or modals for a nicer UX. <em data-start="15724" data-end="15838">Bootstrap toasts are ideal for this: “Toasts are lightweight notifications designed to mimic push notifications”</em><span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://getbootstrap.com/docs/5.0/components/toasts/#:~:text=Toasts%20are%20lightweight%20notifications%20designed,mobile%20and%20desktop%20operating%20systems" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">getbootstrap.com</span></span></span></a></span>, which could slide in non-intrusively instead of alert boxes. The starter code is structured to allow easy insertion of such components. For example, one could replace the <code data-start="16050" data-end="16059">alert()</code> calls in <code data-start="16069" data-end="16077">lib.js</code> with functions that generate toast elements and show them.</p>
<p data-start="16138" data-end="16607" class="">For <strong data-start="16142" data-end="16162">real-time alerts</strong> (for instance, notifying a user that a new parking spot just became free near them), a further step would be integrating WebSockets or Server-Sent Events. With that, the server could push a notification to the client without the client constantly polling. This is noted in the roadmap as a future improvement. In the current project, the assumption is that “real-time” is achieved by refreshing or by the user initiating a search, due to scope.</p>
<p data-start="16609" data-end="17202" class="">The back-end has a placeholder for email notifications. After a booking is made, it prints a message indicating an email would be sent. In practice, you could plug in an email module (such as Flask-Mail or an SMTP library) to send an actual email to the user confirming their reservation. Python’s standard library <code data-start="16924" data-end="16933">smtplib</code> could be used for SMTP communication (<em data-start="16972" data-end="17052">“Python comes with the built-in smtplib module for sending emails using SMTP.”</em><span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://realpython.com/python-send-email/#:~:text=Python%20comes%20with%20the%20built,the%20same%20principles%20apply%20to" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">realpython.com</span></span></span></a></span>). Since this is a starter template, actual email sending isn’t configured, but the extension points are there.</p>
<h2 data-start="17204" data-end="17228" class="">API Endpoints Summary</h2>
<p data-start="17230" data-end="17361" class="">For clarity, here’s a list of the provided API endpoints and their purposes (all prefixed by <code data-start="17323" data-end="17330">/api/</code> and expecting/returning JSON):</p>
<ul data-start="17363" data-end="18908">
<li data-start="17363" data-end="17565" class="">
<p data-start="17365" data-end="17565" class=""><strong data-start="17365" data-end="17389"><code data-start="17367" data-end="17387">POST auth/register</code></strong> – Create a new user account. <strong data-start="17419" data-end="17431">Request:</strong> JSON <code data-start="17437" data-end="17456">{email, password}</code>. <strong data-start="17458" data-end="17471">Response:</strong> JSON message or error. <em data-start="17495" data-end="17565">(Returns 201 on success, or 400 if the email is already registered.)</em></p>
</li>
<li data-start="17566" data-end="17783" class="">
<p data-start="17568" data-end="17783" class=""><strong data-start="17568" data-end="17589"><code data-start="17570" data-end="17587">POST auth/login</code></strong> – Log in a user. <strong data-start="17607" data-end="17619">Request:</strong> JSON <code data-start="17625" data-end="17644">{email, password}</code>. <strong data-start="17646" data-end="17659">Response:</strong> JSON success or error message. On success, a session cookie is set. <em data-start="17728" data-end="17783">(Returns 200 on success, 401 on invalid credentials.)</em></p>
</li>
<li data-start="17784" data-end="17954" class="">
<p data-start="17786" data-end="17954" class=""><strong data-start="17786" data-end="17808"><code data-start="17788" data-end="17806">POST auth/logout</code></strong> – Log out the current user. <strong data-start="17837" data-end="17849">Request:</strong> none (uses session). <strong data-start="17871" data-end="17884">Response:</strong> JSON message. <em data-start="17899" data-end="17954">(Session is cleared server-side; cookie invalidated.)</em></p>
</li>
<li data-start="17955" data-end="18224" class="">
<p data-start="17957" data-end="18224" class=""><strong data-start="17957" data-end="17980"><code data-start="17959" data-end="17978">GET parking/spots</code></strong> – Retrieve available parking spots. <strong data-start="18017" data-end="18029">Request:</strong> none (requires user to be logged in). <strong data-start="18068" data-end="18081">Response:</strong> JSON <code data-start="18087" data-end="18112">{spots: [ {...}, ...] }</code> with each spot’s id, address, coordinates, and hourly rate. <em data-start="18173" data-end="18224">(Returns 200 with data, or 401 if not logged in.)</em></p>
</li>
<li data-start="18225" data-end="18638" class="">
<p data-start="18227" data-end="18638" class=""><strong data-start="18227" data-end="18250"><code data-start="18229" data-end="18248">POST parking/book</code></strong> – Book a parking spot. <strong data-start="18274" data-end="18286">Request:</strong> JSON <code data-start="18292" data-end="18310">{spot_id, hours}</code>. <strong data-start="18312" data-end="18325">Response:</strong> JSON with booking confirmation <code data-start="18357" data-end="18386">{booking_id, cost, message}</code> or an error. Books the spot for the specified duration (in hours) starting now, marks it unavailable, and calculates the cost. <em data-start="18514" data-end="18624">(Returns 200 on success, 400/404 for errors like invalid spot or spot already booked, 401 if not logged in.)</em>  【26†output】</p>
</li>
<li data-start="18639" data-end="18908" class="">
<p data-start="18641" data-end="18908" class=""><strong data-start="18641" data-end="18668"><code data-start="18643" data-end="18666">POST payment/complete</code></strong> – Complete payment for a booking. <strong data-start="18703" data-end="18715">Request:</strong> JSON <code data-start="18721" data-end="18735">{booking_id}</code>. <strong data-start="18737" data-end="18750">Response:</strong> JSON message (and cost) or error. Marks the booking as paid. <em data-start="18812" data-end="18908">(Returns 200 on success, 400 if already paid, 404 if booking not found, 401 if not logged in.)</em></p>
</li>
</ul>
<p data-start="18910" data-end="19181" class="">These endpoints together implement the core logic: account management, listing parking spots, booking a spot (reservation), and simulating payment. The front-end <code data-start="19072" data-end="19080">lib.js</code> contains the logic to call these endpoints and handle responses to provide a smooth user experience.</p>
<h2 data-start="19183" data-end="19205" class="">Running the Project</h2>
<p data-start="19207" data-end="19262" class="">To get started with this project on your local machine:</p>
<ol data-start="19264" data-end="21916">
<li data-start="19264" data-end="19515" class="">
<p data-start="19267" data-end="19515" class=""><strong data-start="19267" data-end="19285">Prerequisites:</strong> Install Python 3 and ensure you have an environment where you can install packages. Clone or unpack the project files. (All dependencies are standard Python libraries except Flask. You can install Flask with <code data-start="19494" data-end="19513">pip install Flask</code>.)</p>
</li>
<li data-start="19516" data-end="19929" class="">
<p data-start="19519" data-end="19929" class=""><strong data-start="19519" data-end="19538">Google API Key:</strong> Sign up for a Google Cloud account if you haven’t, and enable the <strong data-start="19605" data-end="19635">Google Maps JavaScript API</strong> for your project. Obtain an API key. <em data-start="19673" data-end="19787">(Google’s documentation shows how to get an API key in the Cloud console<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://developers.google.com/maps/documentation/javascript/adding-a-google-map#:~:text=Step%201%3A%20Get%20an%20API,key" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">developers.google.com</span></span></span></a></span>.</em>) In the <code data-start="19796" data-end="19827">frontend/templates/index.html</code> file, find the script tag that includes the Maps API and replace <code data-start="19893" data-end="19907">YOUR_API_KEY</code> with your actual key.</p>
</li>
<li data-start="19930" data-end="20223" class="">
<p data-start="19933" data-end="20223" class=""><strong data-start="19933" data-end="19957">Initialize Database:</strong> The first run will create a SQLite database file (<code data-start="20008" data-end="20021">parkping.db</code>). The app will do this automatically. If you want to adjust initial data, you can edit the sample spots inserted in <code data-start="20138" data-end="20146">app.py</code> (near the bottom) or run your own SQL. No separate migration step is needed.</p>
</li>
<li data-start="20224" data-end="20519" class="">
<p data-start="20227" data-end="20519" class=""><strong data-start="20227" data-end="20246">Run the Server:</strong> In a terminal, navigate to the <code data-start="20278" data-end="20288">backend/</code> directory and run <code data-start="20307" data-end="20322">python app.py</code>. Flask will start the development server on <span href="http://127.0.0.1:5000" data-start="20367" data-end="20388" rel="noopener noreferrer" target="_new">http://127.0.0.1:5000</span> by default. (The app is configured with <code data-start="20429" data-end="20441">debug=True</code>, so you’ll see live reloads and detailed error traces in the console if any.)</p>
</li>
<li data-start="20520" data-end="20760" class="">
<p data-start="20523" data-end="20760" class=""><strong data-start="20523" data-end="20540">Open the App:</strong> Visit <strong data-start="20547" data-end="20572"><span href="http://localhost:5000" data-start="20549" data-end="20570" rel="noopener noreferrer" target="_new">http://localhost:5000</span></strong> in your web browser. You should see the login page. (If you see an error about Google Maps, double-check that your API key is correctly inserted and that the API is enabled for that key.)</p>
</li>
<li data-start="20761" data-end="21675" class="">
<p data-start="20764" data-end="21675" class=""><strong data-start="20764" data-end="20786">Test the Features:</strong> Register a new user on the Register page. After submitting, it will redirect you to login – log in with the credentials. Once logged in, you’ll see the main map page. The map will attempt to locate you (look for a permission prompt in your browser). You can use the search bar to center the map on a location of your choice (e.g., try a city name or address). Markers in the map show the seeded parking spots. Click a marker to see its info and book it. When you click “Book this spot”, the app will prompt for number of hours – enter a value (say 1 or 2) – then it will show a confirmation with the cost. If you accept, it will simulate payment. You should see an alert that payment was successful. The marker for that spot will disappear (as it’s now booked/unavailable). You can open the browser console or server log to see the debug prints (e.g., the email notification placeholder).</p>
</li>
<li data-start="21676" data-end="21916" class="">
<p data-start="21679" data-end="21916" class=""><strong data-start="21679" data-end="21696">Inspect Data:</strong> If curious, open the <code data-start="21718" data-end="21731">parkping.db</code> file (using SQLite Browser or command-line sqlite3). You’ll find the tables updated with your user, the booking, etc. This can help you understand the state changes as you use the app.</p>
</li>
</ol>
<p data-start="21918" data-end="22286" class=""><em data-start="21918" data-end="21937">Development tips:</em> This project is a starting point. You can modify the front-end HTML/JS to change the look or add new UI elements (Bootstrap’s components make it easy to add things like dialogs or cards). On the back-end, you can add new routes or extend existing ones. The code is meant to be straightforward to read and extend by developers exploring the project.</p>
<h2 data-start="22288" data-end="22310" class="">Development Roadmap</h2>
<p data-start="22312" data-end="22435" class="">This starter project covers the basics, but there are many opportunities to enhance it into a production-ready application:</p>
<ul data-start="22437" data-end="27283">
<li data-start="22437" data-end="23023" class="">
<p data-start="22439" data-end="23023" class=""><strong data-start="22439" data-end="22461">Real-Time Updates:</strong> Currently, the client would have to poll the server to know if new spots become available. Implementing WebSocket support (using Flask-SocketIO, for example) or Server-Sent Events could allow the server to push notifications to the client when, say, a parking spot becomes free. This would truly enable real-time parking alerts (for instance, notify users “Spot #5 is now available!” without them refreshing). Alternatively, integrating a messaging/queue system for background tasks (e.g., to automatically free up spots whose time has expired) could be useful.</p>
</li>
<li data-start="23024" data-end="23632" class="">
<p data-start="23026" data-end="23632" class=""><strong data-start="23026" data-end="23051">Routing &amp; Directions:</strong> To fully realize the “source-to-destination” flow like Uber, integrate the Google Directions API. After the user chooses a parking spot to book, the app could show directions from the user’s current location to that parking spot, or from the parking spot to the final destination. This could be done by calling the Directions service and displaying the route on the map. (Google Maps Platform allows drawing polylines for routes, etc.) The current UI already gathers a destination; using that, the app could also suggest the closest parking spot to that destination in the future.</p>
</li>
<li data-start="23633" data-end="24054" class="">
<p data-start="23635" data-end="24054" class=""><strong data-start="23635" data-end="23655">Filtering Spots:</strong> If this were deployed in a large area, you’d want to fetch only nearby spots (to save bandwidth and declutter the map). You could enhance <code data-start="23794" data-end="23814">GET /parking/spots</code> to accept parameters like <code data-start="23841" data-end="23874">?near_lat=…&amp;near_lng=…&amp;radius=…</code> to return only spots within a certain distance. The front-end could send the user’s location or destination to filter spots. This would be an easy extension to the current design.</p>
</li>
<li data-start="24055" data-end="24482" class="">
<p data-start="24057" data-end="24482" class=""><strong data-start="24057" data-end="24081">Payment Integration:</strong> Replace the mock payment with a real integration. For example, use Stripe Checkout or their API to process payments securely. Upon booking, you might redirect the user to a payment page, or integrate a credit card form in a modal. Once payment is confirmed by the gateway, update the booking as paid. This involves securely handling payment tokens and perhaps storing transaction IDs in the database.</p>
</li>
<li data-start="24483" data-end="25162" class="">
<p data-start="24485" data-end="24564" class=""><strong data-start="24485" data-end="24508">UI/UX Improvements:</strong> Use Bootstrap components to refine the user experience:</p>
<ul data-start="24567" data-end="25162">
<li data-start="24567" data-end="24716" class="">
<p data-start="24569" data-end="24716" class="">Implement <strong data-start="24579" data-end="24599">Bootstrap Toasts</strong> for notifications instead of alert boxes (non-blocking and can auto-dismiss)<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://getbootstrap.com/docs/5.0/components/toasts/#:~:text=Toasts%20are%20lightweight%20notifications%20designed,mobile%20and%20desktop%20operating%20systems" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">getbootstrap.com</span></span></span></a></span>.</p>
</li>
<li data-start="24719" data-end="24835" class="">
<p data-start="24721" data-end="24835" class="">Add a <strong data-start="24727" data-end="24746">loading spinner</strong> or disable the booking button while a request is in progress to avoid duplicate actions.</p>
</li>
<li data-start="24838" data-end="25022" class="">
<p data-start="24840" data-end="25022" class="">Use <strong data-start="24844" data-end="24863">Bootstrap forms</strong> for login/register with validation feedback. Currently, basic HTML5 required fields are used, but custom validation messages or stronger rules could be added.</p>
</li>
<li data-start="25025" data-end="25162" class="">
<p data-start="25027" data-end="25162" class="">Possibly integrate a front-end framework (React, Vue) if the project grows, but for a simple start Bootstrap + jQuery/JS is sufficient.</p>
</li>
</ul>
</li>
<li data-start="25163" data-end="25603" class="">
<p data-start="25165" data-end="25603" class=""><strong data-start="25165" data-end="25189">Email Notifications:</strong> Build out the email notification system. For example, send an email when a booking is confirmed (the placeholder is there in the code). You could use Flask-Mail extension or external services (SendGrid, etc.). Similarly, if a spot becomes available, users who opted in could get an email or SMS. These features require background job processing in a real app (to avoid delaying the response while sending emails).</p>
</li>
<li data-start="25604" data-end="26145" class="">
<p data-start="25606" data-end="26145" class=""><strong data-start="25606" data-end="25634">Microservice Separation:</strong> Right now the app runs as one Flask service. In a microservices architecture, you might split it into separate services (e.g., an Auth service, a Parking service, a Payment service) that communicate via APIs. Given the current scale, this is not necessary, but the code structure (with clear separation of concerns) makes it easier to break apart if needed. For instance, you could separate <code data-start="26026" data-end="26032">auth</code>, <code data-start="26034" data-end="26043">parking</code>, and <code data-start="26049" data-end="26058">payment</code> into different Flask apps and have a gateway or client orchestrate calls between them.</p>
</li>
<li data-start="26146" data-end="26727" class="">
<p data-start="26148" data-end="26175" class=""><strong data-start="26148" data-end="26174">Security Enhancements:</strong></p>
<ul data-start="26178" data-end="26727">
<li data-start="26178" data-end="26276" class="">
<p data-start="26180" data-end="26276" class="">Use HTTPS in deployment (critical for protecting logins and enabling geolocation in production).</p>
</li>
<li data-start="26279" data-end="26364" class="">
<p data-start="26281" data-end="26364" class="">Implement rate limiting on API endpoints to prevent abuse (Flask-Limiter can help).</p>
</li>
<li data-start="26367" data-end="26482" class="">
<p data-start="26369" data-end="26482" class="">Use Flask’s CSRF protection if you introduce forms that are served by Flask (for pure JSON API, not as relevant).</p>
</li>
<li data-start="26485" data-end="26633" class="">
<p data-start="26487" data-end="26633" class="">Possibly implement JSON Web Tokens (JWT) if you want to decouple the front-end from server sessions (e.g., if turning into a mobile app back-end).</p>
</li>
<li data-start="26636" data-end="26727" class="">
<p data-start="26638" data-end="26727" class="">Improve password handling: require strong passwords, allow password reset via email, etc.</p>
</li>
</ul>
</li>
<li data-start="26728" data-end="26964" class="">
<p data-start="26730" data-end="26964" class=""><strong data-start="26730" data-end="26752">Testing &amp; Quality:</strong> Add unit tests or integration tests for the API endpoints. Use tools like Postman or automated test frameworks (pytest) to test booking logic, etc. This ensures future changes won’t break existing functionality.</p>
</li>
<li data-start="26965" data-end="27283" class="">
<p data-start="26967" data-end="27283" class=""><strong data-start="26967" data-end="26983">Performance:</strong> For a small app, Flask + SQLite is fine. As usage grows, you might move to a more robust database (PostgreSQL/MySQL) and possibly a WSGI server or ASGI server for concurrency. Also, caching frequently requested data (like parking spots that don’t change often) could be considered to reduce DB hits.</p>
</li>
</ul>
<p data-start="27285" data-end="27610" class="">With these enhancements, ParkPing can evolve from a basic starter project to a production-grade service. The current codebase is intentionally kept straightforward and commented for ease of understanding, so new developers can quickly grasp where to add new features or adjust behavior<span class="ms-1 inline-flex max-w-full items-center relative top-[-0.094rem] animate-[show_150ms_ease-in]"><a href="https://www.digitalocean.com/community/tutorials/how-to-structure-a-large-flask-application-with-flask-blueprints-and-flask-sqlalchemy#:~:text=file%20located%20at%20,or%20add%20a%20new%20feature" target="_blank" rel="noopener" class="flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]! transition-colors duration-150 ease-in-out"><span class="relative start-0 bottom-0 flex h-full w-full items-center"><span class="flex h-4 w-full items-center justify-between overflow-hidden" style="opacity: 1; transform: none;"><span class="max-w-full grow truncate overflow-hidden text-center">digitalocean.com</span></span></span></a></span>.</p>
<hr data-start="27612" data-end="27615" class="">
<h2 data-start="27617" data-end="27633" class="">Project Files</h2>
<p data-start="27635" data-end="27768" class="">Below is the complete project code structure with core files. Developers can use this as a reference or starting point for extension:</p>
<h3 data-start="27770" data-end="27790" class=""><code data-start="27774" data-end="27790">backend/app.py</code></h3>
<pre class="overflow-visible!" data-start="27792" data-end="36604"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">python</div><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-python"><span><span><span class="hljs-keyword">from</span></span><span> flask </span><span><span class="hljs-keyword">import</span></span><span> Flask, request, session, redirect, jsonify, g, render_template
</span><span><span class="hljs-keyword">import</span></span><span> sqlite3
</span><span><span class="hljs-keyword">from</span></span><span> datetime </span><span><span class="hljs-keyword">import</span></span><span> datetime, timedelta
</span><span><span class="hljs-keyword">from</span></span><span> werkzeug.security </span><span><span class="hljs-keyword">import</span></span><span> generate_password_hash, check_password_hash

app = Flask(__name__, template_folder=</span><span><span class="hljs-string">'../frontend/templates'</span></span><span>, static_folder=</span><span><span class="hljs-string">'../frontend/static'</span></span><span>)
app.config[</span><span><span class="hljs-string">'SECRET_KEY'</span></span><span>] = </span><span><span class="hljs-string">'dev-secret-key'</span></span><span>  </span><span><span class="hljs-comment"># Use a secure key in production</span></span><span>

</span><span><span class="hljs-comment"># Database configuration</span></span><span>
DATABASE = </span><span><span class="hljs-string">'parkping.db'</span></span><span>

</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">get_db</span></span><span>():
    </span><span><span class="hljs-string">"""Opens a new database connection if there is none yet for the current application context."""</span></span><span>
    db = </span><span><span class="hljs-built_in">getattr</span></span><span>(g, </span><span><span class="hljs-string">'_database'</span></span><span>, </span><span><span class="hljs-literal">None</span></span><span>)
    </span><span><span class="hljs-keyword">if</span></span><span> db </span><span><span class="hljs-keyword">is</span></span><span> </span><span><span class="hljs-literal">None</span></span><span>:
        db = g._database = sqlite3.connect(DATABASE)
        db.row_factory = sqlite3.Row  </span><span><span class="hljs-comment"># to retrieve rows as dict-like objects</span></span><span>
    </span><span><span class="hljs-keyword">return</span></span><span> db

</span><span><span class="hljs-meta">@app.teardown_appcontext</span></span><span>
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">close_connection</span></span><span>(</span><span><span class="hljs-params">exception</span></span><span>):
    </span><span><span class="hljs-string">"""Closes the database again at the end of the request."""</span></span><span>
    db = </span><span><span class="hljs-built_in">getattr</span></span><span>(g, </span><span><span class="hljs-string">'_database'</span></span><span>, </span><span><span class="hljs-literal">None</span></span><span>)
    </span><span><span class="hljs-keyword">if</span></span><span> db </span><span><span class="hljs-keyword">is</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> </span><span><span class="hljs-literal">None</span></span><span>:
        db.close()

</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">init_db</span></span><span>():
    </span><span><span class="hljs-string">"""Initialize the database with required tables if not present."""</span></span><span>
    con = sqlite3.connect(DATABASE)
    cur = con.cursor()
    </span><span><span class="hljs-comment"># Create users table</span></span><span>
    cur.execute(<span class="hljs-string">'''
        CREATE TABLE IF NOT EXISTS users (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            email TEXT UNIQUE NOT NULL,
            password TEXT NOT NULL
        )
    '''</span>)
    </span><span><span class="hljs-comment"># Create parking_spots table</span></span><span>
    cur.execute(<span class="hljs-string">'''
        CREATE TABLE IF NOT EXISTS parking_spots (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            address TEXT,
            lat REAL,
            lng REAL,
            rate REAL,
            is_available INTEGER
        )
    '''</span>)
    </span><span><span class="hljs-comment"># Create bookings table</span></span><span>
    cur.execute(<span class="hljs-string">'''
        CREATE TABLE IF NOT EXISTS bookings (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            user_id INTEGER,
            spot_id INTEGER,
            start_time TEXT,
            end_time TEXT,
            cost REAL,
            paid INTEGER,
            FOREIGN KEY(user_id) REFERENCES users(id),
            FOREIGN KEY(spot_id) REFERENCES parking_spots(id)
        )
    '''</span>)
    con.commit()
    con.close()

</span><span><span class="hljs-comment"># Initialize database at startup</span></span><span>
init_db()

</span><span><span class="hljs-comment"># Define authentication routes</span></span><span>
</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/auth/register'</span></span></span></span><span>, methods=[</span><span><span class="hljs-string">'POST'</span></span><span>])
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">register</span></span><span>():
    data = request.get_json()
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data </span><span><span class="hljs-keyword">or</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data.get(</span><span><span class="hljs-string">'email'</span></span><span>) </span><span><span class="hljs-keyword">or</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data.get(</span><span><span class="hljs-string">'password'</span></span><span>):
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Email and password are required'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    email = data[</span><span><span class="hljs-string">'email'</span></span><span>]
    password = data[</span><span><span class="hljs-string">'password'</span></span><span>]
    hashed_pw = generate_password_hash(password)
    </span><span><span class="hljs-keyword">try</span></span><span>:
        db = get_db()
        cur = db.cursor()
        cur.execute(</span><span><span class="hljs-string">"INSERT INTO users (email, password) VALUES (?, ?)"</span></span><span>, (email, hashed_pw))
        db.commit()
    </span><span><span class="hljs-keyword">except</span></span><span> sqlite3.IntegrityError:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'User already exists'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'message'</span></span><span>: </span><span><span class="hljs-string">'User registered successfully'</span></span><span>}), </span><span><span class="hljs-number">201</span></span><span>

</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/auth/login'</span></span></span></span><span>, methods=[</span><span><span class="hljs-string">'POST'</span></span><span>])
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">login</span></span><span>():
    data = request.get_json()
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data </span><span><span class="hljs-keyword">or</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data.get(</span><span><span class="hljs-string">'email'</span></span><span>) </span><span><span class="hljs-keyword">or</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data.get(</span><span><span class="hljs-string">'password'</span></span><span>):
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Email and password are required'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    email = data[</span><span><span class="hljs-string">'email'</span></span><span>]
    password = data[</span><span><span class="hljs-string">'password'</span></span><span>]
    db = get_db()
    cur = db.cursor()
    cur.execute(</span><span><span class="hljs-string">"SELECT id, password FROM users WHERE email = ?"</span></span><span>, (email,))
    row = cur.fetchone()
    </span><span><span class="hljs-keyword">if</span></span><span> row </span><span><span class="hljs-keyword">is</span></span><span> </span><span><span class="hljs-literal">None</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Invalid credentials'</span></span><span>}), </span><span><span class="hljs-number">401</span></span><span>
    user_id = row[</span><span><span class="hljs-string">'id'</span></span><span>]
    stored_password = row[</span><span><span class="hljs-string">'password'</span></span><span>]
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> check_password_hash(stored_password, password):
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Invalid credentials'</span></span><span>}), </span><span><span class="hljs-number">401</span></span><span>
    </span><span><span class="hljs-comment"># Credentials valid, set session</span></span><span>
    session[</span><span><span class="hljs-string">'user_id'</span></span><span>] = user_id
    session[</span><span><span class="hljs-string">'user_email'</span></span><span>] = email
    </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'message'</span></span><span>: </span><span><span class="hljs-string">'Login successful'</span></span><span>}), </span><span><span class="hljs-number">200</span></span><span>

</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/auth/logout'</span></span></span></span><span>, methods=[</span><span><span class="hljs-string">'POST'</span></span><span>])
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">logout</span></span><span>():
    session.clear()
    </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'message'</span></span><span>: </span><span><span class="hljs-string">'Logged out'</span></span><span>}), </span><span><span class="hljs-number">200</span></span><span>

</span><span><span class="hljs-comment"># Define parking routes</span></span><span>
</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/parking/spots'</span></span></span></span><span>, methods=[</span><span><span class="hljs-string">'GET'</span></span><span>])
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">get_spots</span></span><span>():
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-string">'user_id'</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> session:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Unauthorized'</span></span><span>}), </span><span><span class="hljs-number">401</span></span><span>
    db = get_db()
    cur = db.cursor()
    cur.execute(</span><span><span class="hljs-string">"SELECT id, address, lat, lng, rate FROM parking_spots WHERE is_available = 1"</span></span><span>)
    rows = cur.fetchall()
    spots = []
    </span><span><span class="hljs-keyword">for</span></span><span> row </span><span><span class="hljs-keyword">in</span></span><span> rows:
        spots.append({
            </span><span><span class="hljs-string">'id'</span></span><span>: row[</span><span><span class="hljs-string">'id'</span></span><span>],
            </span><span><span class="hljs-string">'address'</span></span><span>: row[</span><span><span class="hljs-string">'address'</span></span><span>],
            </span><span><span class="hljs-string">'lat'</span></span><span>: row[</span><span><span class="hljs-string">'lat'</span></span><span>],
            </span><span><span class="hljs-string">'lng'</span></span><span>: row[</span><span><span class="hljs-string">'lng'</span></span><span>],
            </span><span><span class="hljs-string">'rate'</span></span><span>: row[</span><span><span class="hljs-string">'rate'</span></span><span>]
        })
    </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'spots'</span></span><span>: spots}), </span><span><span class="hljs-number">200</span></span><span>

</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/parking/book'</span></span></span></span><span>, methods=[</span><span><span class="hljs-string">'POST'</span></span><span>])
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">book_spot</span></span><span>():
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-string">'user_id'</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> session:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Unauthorized'</span></span><span>}), </span><span><span class="hljs-number">401</span></span><span>
    data = request.get_json()
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data </span><span><span class="hljs-keyword">or</span></span><span> </span><span><span class="hljs-string">'spot_id'</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> data </span><span><span class="hljs-keyword">or</span></span><span> </span><span><span class="hljs-string">'hours'</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> data:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'spot_id and hours are required'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    spot_id = data[</span><span><span class="hljs-string">'spot_id'</span></span><span>]
    </span><span><span class="hljs-keyword">try</span></span><span>:
        hours = </span><span><span class="hljs-built_in">float</span></span><span>(data[</span><span><span class="hljs-string">'hours'</span></span><span>])
    </span><span><span class="hljs-keyword">except</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Invalid hours value'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    </span><span><span class="hljs-keyword">if</span></span><span> hours &lt;= </span><span><span class="hljs-number">0</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Hours must be greater than 0'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    user_id = session[</span><span><span class="hljs-string">'user_id'</span></span><span>]
    db = get_db()
    cur = db.cursor()
    </span><span><span class="hljs-comment"># Check spot availability</span></span><span>
    cur.execute(</span><span><span class="hljs-string">"SELECT rate, is_available FROM parking_spots WHERE id = ?"</span></span><span>, (spot_id,))
    spot = cur.fetchone()
    </span><span><span class="hljs-keyword">if</span></span><span> spot </span><span><span class="hljs-keyword">is</span></span><span> </span><span><span class="hljs-literal">None</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Parking spot not found'</span></span><span>}), </span><span><span class="hljs-number">404</span></span><span>
    </span><span><span class="hljs-keyword">if</span></span><span> spot[</span><span><span class="hljs-string">'is_available'</span></span><span>] == </span><span><span class="hljs-number">0</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Parking spot is already booked'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    rate = spot[</span><span><span class="hljs-string">'rate'</span></span><span>]
    cost = rate * hours
    </span><span><span class="hljs-comment"># Reserve the spot (mark as unavailable)</span></span><span>
    cur.execute(</span><span><span class="hljs-string">"UPDATE parking_spots SET is_available = 0 WHERE id = ?"</span></span><span>, (spot_id,))
    </span><span><span class="hljs-comment"># Create a booking record</span></span><span>
    start_time = datetime.now()
    end_time = start_time + timedelta(hours=hours)
    cur.execute(
        </span><span><span class="hljs-string">"INSERT INTO bookings (user_id, spot_id, start_time, end_time, cost, paid) VALUES (?, ?, ?, ?, ?, ?)"</span></span><span>,
        (user_id, spot_id, start_time.strftime(</span><span><span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span></span><span>), end_time.strftime(</span><span><span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span></span><span>), cost, </span><span><span class="hljs-number">0</span></span><span>)
    )
    booking_id = cur.lastrowid
    db.commit()
    </span><span><span class="hljs-comment"># Placeholder for sending notification (e.g., email)</span></span><span>
    user_email = session.get(</span><span><span class="hljs-string">'user_email'</span></span><span>)
    </span><span><span class="hljs-keyword">if</span></span><span> user_email:
        </span><span><span class="hljs-built_in">print</span></span><span>(</span><span><span class="hljs-string">f"[Notification] Parking spot <span class="hljs-subst">{spot_id}</span></span></span><span> booked by </span><span><span class="hljs-subst">{user_email}</span></span><span>. Confirmation email sent.")
    </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'message'</span></span><span>: </span><span><span class="hljs-string">'Spot booked successfully'</span></span><span>, </span><span><span class="hljs-string">'booking_id'</span></span><span>: booking_id, </span><span><span class="hljs-string">'cost'</span></span><span>: cost}), </span><span><span class="hljs-number">200</span></span><span>

</span><span><span class="hljs-comment"># Define payment route</span></span><span>
</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/api/payment/complete'</span></span></span></span><span>, methods=[</span><span><span class="hljs-string">'POST'</span></span><span>])
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">complete_payment</span></span><span>():
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-string">'user_id'</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> session:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Unauthorized'</span></span><span>}), </span><span><span class="hljs-number">401</span></span><span>
    data = request.get_json()
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> data </span><span><span class="hljs-keyword">or</span></span><span> </span><span><span class="hljs-string">'booking_id'</span></span><span> </span><span><span class="hljs-keyword">not</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> data:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'booking_id is required'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    booking_id = data[</span><span><span class="hljs-string">'booking_id'</span></span><span>]
    db = get_db()
    cur = db.cursor()
    cur.execute(</span><span><span class="hljs-string">"SELECT cost, paid, spot_id FROM bookings WHERE id = ? AND user_id = ?"</span></span><span>, (booking_id, session[</span><span><span class="hljs-string">'user_id'</span></span><span>]))
    booking = cur.fetchone()
    </span><span><span class="hljs-keyword">if</span></span><span> booking </span><span><span class="hljs-keyword">is</span></span><span> </span><span><span class="hljs-literal">None</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Booking not found'</span></span><span>}), </span><span><span class="hljs-number">404</span></span><span>
    </span><span><span class="hljs-keyword">if</span></span><span> booking[</span><span><span class="hljs-string">'paid'</span></span><span>] == </span><span><span class="hljs-number">1</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'error'</span></span><span>: </span><span><span class="hljs-string">'Payment already completed for this booking'</span></span><span>}), </span><span><span class="hljs-number">400</span></span><span>
    </span><span><span class="hljs-comment"># Process payment (mock)</span></span><span>
    cur.execute(</span><span><span class="hljs-string">"UPDATE bookings SET paid = 1 WHERE id = ?"</span></span><span>, (booking_id,))
    db.commit()
    </span><span><span class="hljs-comment"># In a real app, you'd integrate with a payment gateway here</span></span><span>
    cost = booking[</span><span><span class="hljs-string">'cost'</span></span><span>]
    </span><span><span class="hljs-keyword">return</span></span><span> jsonify({</span><span><span class="hljs-string">'message'</span></span><span>: </span><span><span class="hljs-string">'Payment completed successfully'</span></span><span>, </span><span><span class="hljs-string">'cost'</span></span><span>: cost}), </span><span><span class="hljs-number">200</span></span><span>

</span><span><span class="hljs-comment"># Frontend routes for pages</span></span><span>
</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/'</span></span></span></span><span>)
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">index_page</span></span><span>():
    </span><span><span class="hljs-comment"># If user is logged in, show main app, otherwise show login</span></span><span>
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-string">'user_id'</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> session:
        </span><span><span class="hljs-keyword">return</span></span><span> render_template(</span><span><span class="hljs-string">'index.html'</span></span><span>)
    </span><span><span class="hljs-keyword">else</span></span><span>:
        </span><span><span class="hljs-keyword">return</span></span><span> render_template(</span><span><span class="hljs-string">'login.html'</span></span><span>)

</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/login'</span></span></span></span><span>)
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">login_page</span></span><span>():
    </span><span><span class="hljs-comment"># If already logged in, go to main page</span></span><span>
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-string">'user_id'</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> session:
        </span><span><span class="hljs-keyword">return</span></span><span> redirect(</span><span><span class="hljs-string">'/'</span></span><span>)
    </span><span><span class="hljs-keyword">return</span></span><span> render_template(</span><span><span class="hljs-string">'login.html'</span></span><span>)

</span><span><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/register'</span></span></span></span><span>)
</span><span><span class="hljs-keyword">def</span></span><span> </span><span><span class="hljs-title function_">register_page</span></span><span>():
    </span><span><span class="hljs-keyword">if</span></span><span> </span><span><span class="hljs-string">'user_id'</span></span><span> </span><span><span class="hljs-keyword">in</span></span><span> session:
        </span><span><span class="hljs-keyword">return</span></span><span> redirect(</span><span><span class="hljs-string">'/'</span></span><span>)
    </span><span><span class="hljs-keyword">return</span></span><span> render_template(</span><span><span class="hljs-string">'register.html'</span></span><span>)

</span><span><span class="hljs-comment"># Seed some sample parking data if none exists (for demo purposes)</span></span><span>
</span><span><span class="hljs-keyword">with</span></span><span> app.app_context():
    db = get_db()
    cur = db.cursor()
    cur.execute(</span><span><span class="hljs-string">"SELECT COUNT(*) as cnt FROM parking_spots"</span></span><span>)
    cnt = cur.fetchone()[</span><span><span class="hljs-string">'cnt'</span></span><span>]
    </span><span><span class="hljs-keyword">if</span></span><span> cnt == </span><span><span class="hljs-number">0</span></span><span>:
        sample_spots = [
            (</span><span><span class="hljs-string">"Downtown Parking Lot 1"</span></span><span>, </span><span><span class="hljs-number">51.046</span></span><span>, -</span><span><span class="hljs-number">114.065</span></span><span>, </span><span><span class="hljs-number">2.5</span></span><span>, </span><span><span class="hljs-number">1</span></span><span>),
            (</span><span><span class="hljs-string">"Downtown Parking Lot 2"</span></span><span>, </span><span><span class="hljs-number">51.045</span></span><span>, -</span><span><span class="hljs-number">114.066</span></span><span>, </span><span><span class="hljs-number">3.0</span></span><span>, </span><span><span class="hljs-number">1</span></span><span>),
            (</span><span><span class="hljs-string">"Mall Parking Garage"</span></span><span>, </span><span><span class="hljs-number">51.050</span></span><span>, -</span><span><span class="hljs-number">114.070</span></span><span>, </span><span><span class="hljs-number">1.5</span></span><span>, </span><span><span class="hljs-number">1</span></span><span>)
        ]
        </span><span><span class="hljs-keyword">for</span></span><span> address, lat, lng, rate, avail </span><span><span class="hljs-keyword">in</span></span><span> sample_spots:
            cur.execute(</span><span><span class="hljs-string">"INSERT INTO parking_spots (address, lat, lng, rate, is_available) VALUES (?, ?, ?, ?, ?)"</span></span><span>,
                        (address, lat, lng, rate, avail))
        db.commit()

</span><span><span class="hljs-keyword">if</span></span><span> __name__ == </span><span><span class="hljs-string">'__main__'</span></span><span>:
    app.run(debug=</span><span><span class="hljs-literal">True</span></span><span>)
</span></span></code></div></div></pre>
<h3 data-start="36606" data-end="36641" class=""><code data-start="36610" data-end="36641">frontend/templates/index.html</code></h3>
<pre class="overflow-visible!" data-start="36643" data-end="38191"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">html</div><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-html"><span><span><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">html</span></span></span><span> </span><span><span class="hljs-attr">lang</span></span><span>=</span><span><span class="hljs-string">"en"</span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">head</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span></span></span><span> </span><span><span class="hljs-attr">charset</span></span><span>=</span><span><span class="hljs-string">"UTF-8"</span></span><span> /&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span></span></span><span> </span><span><span class="hljs-attr">name</span></span><span>=</span><span><span class="hljs-string">"viewport"</span></span><span> </span><span><span class="hljs-attr">content</span></span><span>=</span><span><span class="hljs-string">"width=device-width, initial-scale=1"</span></span><span> /&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">title</span></span></span><span>&gt;ParkPing - Find Parking</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"</span></span><span> </span><span><span class="hljs-attr">rel</span></span><span>=</span><span><span class="hljs-string">"stylesheet"</span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><span> </span><span><span class="hljs-attr">rel</span></span><span>=</span><span><span class="hljs-string">"stylesheet"</span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"/static/style.css"</span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">body</span></span></span><span>&gt;
  </span><span><span class="hljs-comment">&lt;!-- Navigation Bar --&gt;</span></span><span>
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">nav</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"navbar navbar-expand-lg navbar-dark bg-dark"</span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"container-fluid"</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">a</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"navbar-brand"</span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"#"</span></span><span>&gt;ParkPing</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"d-flex"</span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"logoutBtn"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"btn btn-outline-light"</span></span><span>&gt;Logout</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">nav</span></span></span><span>&gt;
  </span><span><span class="hljs-comment">&lt;!-- Search bar --&gt;</span></span><span>
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"container my-3"</span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"row"</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"col-md-8"</span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"text"</span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"destination"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-control"</span></span><span> </span><span><span class="hljs-attr">placeholder</span></span><span>=</span><span><span class="hljs-string">"Enter destination address"</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"col-md-4"</span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"btn btn-primary w-100"</span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"searchBtn"</span></span><span>&gt;Find Parking</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
  </span><span><span class="hljs-comment">&lt;!-- Map --&gt;</span></span><span>
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"container-fluid px-0"</span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"map"</span></span><span> </span><span><span class="hljs-attr">style</span></span><span>=</span><span><span class="hljs-string">"height: 75vh; width: 100%;"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;

  </span><span><span class="hljs-comment">&lt;!-- Include JS at bottom for faster load --&gt;</span></span><span>
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"/static/lib.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt;
  </span><span><span class="hljs-comment">&lt;!-- Google Maps API (replace YOUR_API_KEY with actual key) --&gt;</span></span><span>
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">async</span></span><span> </span><span><span class="hljs-attr">defer</span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&amp;callback=initMap"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span></span></span><span>&gt;
</span></span></code></div></div></pre>
<h3 data-start="38193" data-end="38228" class=""><code data-start="38197" data-end="38228">frontend/templates/login.html</code></h3>
<pre class="overflow-visible!" data-start="38230" data-end="39575"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">html</div><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-html"><span><span><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">html</span></span></span><span> </span><span><span class="hljs-attr">lang</span></span><span>=</span><span><span class="hljs-string">"en"</span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">head</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span></span></span><span> </span><span><span class="hljs-attr">charset</span></span><span>=</span><span><span class="hljs-string">"UTF-8"</span></span><span> /&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span></span></span><span> </span><span><span class="hljs-attr">name</span></span><span>=</span><span><span class="hljs-string">"viewport"</span></span><span> </span><span><span class="hljs-attr">content</span></span><span>=</span><span><span class="hljs-string">"width=device-width, initial-scale=1"</span></span><span> /&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">title</span></span></span><span>&gt;ParkPing - Login</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"</span></span><span> </span><span><span class="hljs-attr">rel</span></span><span>=</span><span><span class="hljs-string">"stylesheet"</span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><span> </span><span><span class="hljs-attr">rel</span></span><span>=</span><span><span class="hljs-string">"stylesheet"</span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"/static/style.css"</span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">body</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"d-flex align-items-center justify-content-center"</span></span><span> </span><span><span class="hljs-attr">style</span></span><span>=</span><span><span class="hljs-string">"min-height: 100vh;"</span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"container"</span></span><span> </span><span><span class="hljs-attr">style</span></span><span>=</span><span><span class="hljs-string">"max-width: 400px;"</span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mb-4 text-center"</span></span><span>&gt;Sign In to ParkPing</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span></span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;<span class="hljs-name">form</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"loginForm"</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mb-3"</span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">label</span></span></span><span> </span><span><span class="hljs-attr">for</span></span><span>=</span><span><span class="hljs-string">"email"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-label"</span></span><span>&gt;Email address</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span></span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"email"</span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"email"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-control"</span></span><span> </span><span><span class="hljs-attr">required</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mb-3"</span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">label</span></span></span><span> </span><span><span class="hljs-attr">for</span></span><span>=</span><span><span class="hljs-string">"password"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-label"</span></span><span>&gt;Password</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span></span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"password"</span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"password"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-control"</span></span><span> </span><span><span class="hljs-attr">required</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"submit"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"btn btn-primary w-100"</span></span><span>&gt;Login</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">p</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mt-3 text-center"</span></span><span>&gt;No account? </span><span><span class="hljs-tag">&lt;<span class="hljs-name">a</span></span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"/register"</span></span><span>&gt;Register here</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span></span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"loginError"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"text-danger mt-2 text-center"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">form</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"/static/lib.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span></span></span><span>&gt;
</span></span></code></div></div></pre>
<h3 data-start="39577" data-end="39615" class=""><code data-start="39581" data-end="39615">frontend/templates/register.html</code></h3>
<pre class="overflow-visible!" data-start="39617" data-end="41064"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">html</div><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-html"><span><span><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">html</span></span></span><span> </span><span><span class="hljs-attr">lang</span></span><span>=</span><span><span class="hljs-string">"en"</span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">head</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span></span></span><span> </span><span><span class="hljs-attr">charset</span></span><span>=</span><span><span class="hljs-string">"UTF-8"</span></span><span> /&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span></span></span><span> </span><span><span class="hljs-attr">name</span></span><span>=</span><span><span class="hljs-string">"viewport"</span></span><span> </span><span><span class="hljs-attr">content</span></span><span>=</span><span><span class="hljs-string">"width=device-width, initial-scale=1"</span></span><span> /&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">title</span></span></span><span>&gt;ParkPing - Register</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"</span></span><span> </span><span><span class="hljs-attr">rel</span></span><span>=</span><span><span class="hljs-string">"stylesheet"</span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">link</span></span></span><span> </span><span><span class="hljs-attr">rel</span></span><span>=</span><span><span class="hljs-string">"stylesheet"</span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"/static/style.css"</span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;<span class="hljs-name">body</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"d-flex align-items-center justify-content-center"</span></span><span> </span><span><span class="hljs-attr">style</span></span><span>=</span><span><span class="hljs-string">"min-height: 100vh;"</span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"container"</span></span><span> </span><span><span class="hljs-attr">style</span></span><span>=</span><span><span class="hljs-string">"max-width: 400px;"</span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mb-4 text-center"</span></span><span>&gt;Create an Account</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span></span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;<span class="hljs-name">form</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"registerForm"</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mb-3"</span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">label</span></span></span><span> </span><span><span class="hljs-attr">for</span></span><span>=</span><span><span class="hljs-string">"regEmail"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-label"</span></span><span>&gt;Email address</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span></span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"email"</span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"regEmail"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-control"</span></span><span> </span><span><span class="hljs-attr">required</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mb-3"</span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">label</span></span></span><span> </span><span><span class="hljs-attr">for</span></span><span>=</span><span><span class="hljs-string">"regPassword"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-label"</span></span><span>&gt;Password</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span></span></span><span>&gt;
        </span><span><span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"password"</span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"regPassword"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"form-control"</span></span><span> </span><span><span class="hljs-attr">required</span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"submit"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"btn btn-success w-100"</span></span><span>&gt;Sign Up</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">p</span></span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"mt-3 text-center"</span></span><span>&gt;Already have an account? </span><span><span class="hljs-tag">&lt;<span class="hljs-name">a</span></span></span><span> </span><span><span class="hljs-attr">href</span></span><span>=</span><span><span class="hljs-string">"/login"</span></span><span>&gt;Sign in</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span></span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"registerError"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"text-danger mt-2 text-center"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
      </span><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"registerSuccess"</span></span><span> </span><span><span class="hljs-attr">class</span></span><span>=</span><span><span class="hljs-string">"text-success mt-2 text-center"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
    </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">form</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt;
  </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"/static/lib.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span></span></span><span>&gt;
</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span></span></span><span>&gt;
</span></span></code></div></div></pre>
<h3 data-start="41066" data-end="41094" class=""><code data-start="41070" data-end="41094">frontend/static/lib.js</code></h3>
<pre class="overflow-visible!" data-start="41096" data-end="48648"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">javascript</div><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-javascript"><span><span><span class="hljs-keyword">let</span></span><span> map;
</span><span><span class="hljs-keyword">let</span></span><span> userMarker;
</span><span><span class="hljs-keyword">let</span></span><span> destMarker;
</span><span><span class="hljs-keyword">let</span></span><span> spotMarkers = [];

</span><span><span class="hljs-comment">// Initialize Google Map and load parking spots</span></span><span>
</span><span><span class="hljs-keyword">function</span></span><span> </span><span><span class="hljs-title function_">initMap</span></span><span>(</span><span><span class="hljs-params"></span></span><span>) {
  </span><span><span class="hljs-comment">// Default location (if geolocation not available) - using sample location (downtown of a city)</span></span><span>
  </span><span><span class="hljs-keyword">const</span></span><span> defaultLoc = { </span><span><span class="hljs-attr">lat</span></span><span>: </span><span><span class="hljs-number">51.046</span></span><span>, </span><span><span class="hljs-attr">lng</span></span><span>: -</span><span><span class="hljs-number">114.065</span></span><span> }; 
  map = </span><span><span class="hljs-keyword">new</span></span><span> google.</span><span><span class="hljs-property">maps</span></span><span>.</span><span><span class="hljs-title class_">Map</span></span><span>(</span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'map'</span></span><span>), {
    </span><span><span class="hljs-attr">center</span></span><span>: defaultLoc,
    </span><span><span class="hljs-attr">zoom</span></span><span>: </span><span><span class="hljs-number">14</span></span><span>
  });
  </span><span><span class="hljs-comment">// Try HTML5 geolocation to get user's current location</span></span><span>
  </span><span><span class="hljs-keyword">if</span></span><span> (navigator.</span><span><span class="hljs-property">geolocation</span></span><span>) {
    navigator.</span><span><span class="hljs-property">geolocation</span></span><span>.</span><span><span class="hljs-title function_">getCurrentPosition</span></span><span>(
      </span><span><span class="hljs-function">(<span class="hljs-params">position</span></span></span><span>) =&gt; {
        </span><span><span class="hljs-keyword">const</span></span><span> userLoc = { </span><span><span class="hljs-attr">lat</span></span><span>: position.</span><span><span class="hljs-property">coords</span></span><span>.</span><span><span class="hljs-property">latitude</span></span><span>, </span><span><span class="hljs-attr">lng</span></span><span>: position.</span><span><span class="hljs-property">coords</span></span><span>.</span><span><span class="hljs-property">longitude</span></span><span> };
        map.</span><span><span class="hljs-title function_">setCenter</span></span><span>(userLoc);
        </span><span><span class="hljs-comment">// Add marker for user's location</span></span><span>
        userMarker = </span><span><span class="hljs-keyword">new</span></span><span> google.</span><span><span class="hljs-property">maps</span></span><span>.</span><span><span class="hljs-title class_">Marker</span></span><span>({
          </span><span><span class="hljs-attr">position</span></span><span>: userLoc,
          </span><span><span class="hljs-attr">map</span></span><span>: map,
          </span><span><span class="hljs-attr">title</span></span><span>: </span><span><span class="hljs-string">"You are here"</span></span><span>,
          </span><span><span class="hljs-attr">icon</span></span><span>: {
            </span><span><span class="hljs-attr">path</span></span><span>: google.</span><span><span class="hljs-property">maps</span></span><span>.</span><span><span class="hljs-property">SymbolPath</span></span><span>.</span><span><span class="hljs-property">CIRCLE</span></span><span>,
            </span><span><span class="hljs-attr">scale</span></span><span>: </span><span><span class="hljs-number">8</span></span><span>,
            </span><span><span class="hljs-attr">fillColor</span></span><span>: </span><span><span class="hljs-string">"#4285F4"</span></span><span>,
            </span><span><span class="hljs-attr">fillOpacity</span></span><span>: </span><span><span class="hljs-number">1</span></span><span>,
            </span><span><span class="hljs-attr">strokeColor</span></span><span>: </span><span><span class="hljs-string">"#ffffff"</span></span><span>,
            </span><span><span class="hljs-attr">strokeWeight</span></span><span>: </span><span><span class="hljs-number">2</span></span><span>
          }
        });
      },
      </span><span><span class="hljs-function">(<span class="hljs-params">error</span></span></span><span>) =&gt; {
        </span><span><span class="hljs-variable language_">console</span></span><span>.</span><span><span class="hljs-title function_">warn</span></span><span>(</span><span><span class="hljs-string">'Geolocation failed or denied.'</span></span><span>, error);
      }
    );
  }
  </span><span><span class="hljs-comment">// Load available parking spots from API</span></span><span>
  </span><span><span class="hljs-title function_">loadSpots</span></span><span>();
}

</span><span><span class="hljs-comment">// Fetch spots from backend and display on map</span></span><span>
</span><span><span class="hljs-keyword">function</span></span><span> </span><span><span class="hljs-title function_">loadSpots</span></span><span>(</span><span><span class="hljs-params"></span></span><span>) {
  </span><span><span class="hljs-title function_">fetch</span></span><span>(</span><span><span class="hljs-string">'/api/parking/spots'</span></span><span>)
    .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">response</span></span></span><span> =&gt; response.</span><span><span class="hljs-title function_">json</span></span><span>())
    .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">data</span></span></span><span> =&gt; {
      </span><span><span class="hljs-keyword">if</span></span><span> (data.</span><span><span class="hljs-property">error</span></span><span>) {
        </span><span><span class="hljs-variable language_">console</span></span><span>.</span><span><span class="hljs-title function_">error</span></span><span>(</span><span><span class="hljs-string">"Error loading spots:"</span></span><span>, data.</span><span><span class="hljs-property">error</span></span><span>);
        </span><span><span class="hljs-keyword">return</span></span><span>;
      }
      </span><span><span class="hljs-comment">// Remove existing spot markers</span></span><span>
      spotMarkers.</span><span><span class="hljs-title function_">forEach</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">m</span></span></span><span> =&gt; m.</span><span><span class="hljs-title function_">setMap</span></span><span>(</span><span><span class="hljs-literal">null</span></span><span>));
      spotMarkers = [];
      data.</span><span><span class="hljs-property">spots</span></span><span>.</span><span><span class="hljs-title function_">forEach</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">spot</span></span></span><span> =&gt; {
        </span><span><span class="hljs-keyword">const</span></span><span> pos = { </span><span><span class="hljs-attr">lat</span></span><span>: spot.</span><span><span class="hljs-property">lat</span></span><span>, </span><span><span class="hljs-attr">lng</span></span><span>: spot.</span><span><span class="hljs-property">lng</span></span><span> };
        </span><span><span class="hljs-keyword">const</span></span><span> marker = </span><span><span class="hljs-keyword">new</span></span><span> google.</span><span><span class="hljs-property">maps</span></span><span>.</span><span><span class="hljs-title class_">Marker</span></span><span>({
          </span><span><span class="hljs-attr">position</span></span><span>: pos,
          </span><span><span class="hljs-attr">map</span></span><span>: map,
          </span><span><span class="hljs-attr">title</span></span><span>: spot.</span><span><span class="hljs-property">address</span></span><span> || </span><span><span class="hljs-string">"Parking Spot"</span></span><span>,
          </span><span><span class="hljs-comment">// could use custom icon for parking spot here</span></span><span>
        });
        </span><span><span class="hljs-comment">// Info window content with a Book button</span></span><span>
        </span><span><span class="hljs-keyword">const</span></span><span> infoContent = <span class="hljs-string">`
          &lt;div&gt;
            &lt;h6&gt;</span></span><span><span class="hljs-subst">${spot.address}</span></span><span>&lt;/h6&gt;
            &lt;p&gt;Rate: $</span><span><span class="hljs-subst">${spot.rate.toFixed(<span class="hljs-number">2</span></span></span><span>)}/hour&lt;/p&gt;
            &lt;button class="btn btn-sm btn-primary" onclick="bookSpot(</span><span><span class="hljs-subst">${spot.id}</span></span><span>)"&gt;Book this spot&lt;/button&gt;
          &lt;/div&gt;`;
        </span><span><span class="hljs-keyword">const</span></span><span> infowindow = </span><span><span class="hljs-keyword">new</span></span><span> google.</span><span><span class="hljs-property">maps</span></span><span>.</span><span><span class="hljs-title class_">InfoWindow</span></span><span>();
        marker.</span><span><span class="hljs-title function_">addListener</span></span><span>(</span><span><span class="hljs-string">'click'</span></span><span>, </span><span><span class="hljs-function">() =&gt;</span></span><span> {
          infowindow.</span><span><span class="hljs-title function_">setContent</span></span><span>(infoContent);
          infowindow.</span><span><span class="hljs-title function_">open</span></span><span>(map, marker);
        });
        spotMarkers.</span><span><span class="hljs-title function_">push</span></span><span>(marker);
      });
    });
}

</span><span><span class="hljs-comment">// Book a parking spot for a given number of hours</span></span><span>
</span><span><span class="hljs-keyword">function</span></span><span> </span><span><span class="hljs-title function_">bookSpot</span></span><span>(</span><span><span class="hljs-params">spotId</span></span><span>) {
  </span><span><span class="hljs-keyword">const</span></span><span> hrs = </span><span><span class="hljs-title function_">prompt</span></span><span>(</span><span><span class="hljs-string">"Enter number of hours to book:"</span></span><span>);
  </span><span><span class="hljs-keyword">if</span></span><span> (hrs === </span><span><span class="hljs-literal">null</span></span><span>) </span><span><span class="hljs-keyword">return</span></span><span>; </span><span><span class="hljs-comment">// cancelled</span></span><span>
  </span><span><span class="hljs-keyword">const</span></span><span> hours = </span><span><span class="hljs-built_in">parseFloat</span></span><span>(hrs);
  </span><span><span class="hljs-keyword">if</span></span><span> (</span><span><span class="hljs-built_in">isNaN</span></span><span>(hours) || hours &lt;= </span><span><span class="hljs-number">0</span></span><span>) {
    </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Please enter a valid number of hours."</span></span><span>);
    </span><span><span class="hljs-keyword">return</span></span><span>;
  }
  </span><span><span class="hljs-title function_">fetch</span></span><span>(</span><span><span class="hljs-string">'/api/parking/book'</span></span><span>, {
    </span><span><span class="hljs-attr">method</span></span><span>: </span><span><span class="hljs-string">'POST'</span></span><span>,
    </span><span><span class="hljs-attr">headers</span></span><span>: { </span><span><span class="hljs-string">'Content-Type'</span></span><span>: </span><span><span class="hljs-string">'application/json'</span></span><span> },
    </span><span><span class="hljs-attr">body</span></span><span>: </span><span><span class="hljs-title class_">JSON</span></span><span>.</span><span><span class="hljs-title function_">stringify</span></span><span>({ </span><span><span class="hljs-attr">spot_id</span></span><span>: spotId, </span><span><span class="hljs-attr">hours</span></span><span>: hours })
  })
  .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">response</span></span></span><span> =&gt; response.</span><span><span class="hljs-title function_">json</span></span><span>())
  .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">data</span></span></span><span> =&gt; {
    </span><span><span class="hljs-keyword">if</span></span><span> (data.</span><span><span class="hljs-property">error</span></span><span>) {
      </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Error: "</span></span><span> + data.</span><span><span class="hljs-property">error</span></span><span>);
      </span><span><span class="hljs-keyword">return</span></span><span>;
    }
    </span><span><span class="hljs-keyword">const</span></span><span> cost = data.</span><span><span class="hljs-property">cost</span></span><span>;
    </span><span><span class="hljs-keyword">const</span></span><span> bookingId = data.</span><span><span class="hljs-property">booking_id</span></span><span>;
    </span><span><span class="hljs-comment">// Confirm payment</span></span><span>
    </span><span><span class="hljs-keyword">const</span></span><span> payNow = </span><span><span class="hljs-title function_">confirm</span></span><span>(</span><span><span class="hljs-string">`Spot booked for $<span class="hljs-subst">${cost.toFixed(<span class="hljs-number">2</span></span></span></span><span>)}. Proceed to payment?`);
    </span><span><span class="hljs-keyword">if</span></span><span> (payNow) {
      </span><span><span class="hljs-title function_">fetch</span></span><span>(</span><span><span class="hljs-string">'/api/payment/complete'</span></span><span>, {
        </span><span><span class="hljs-attr">method</span></span><span>: </span><span><span class="hljs-string">'POST'</span></span><span>,
        </span><span><span class="hljs-attr">headers</span></span><span>: { </span><span><span class="hljs-string">'Content-Type'</span></span><span>: </span><span><span class="hljs-string">'application/json'</span></span><span> },
        </span><span><span class="hljs-attr">body</span></span><span>: </span><span><span class="hljs-title class_">JSON</span></span><span>.</span><span><span class="hljs-title function_">stringify</span></span><span>({ </span><span><span class="hljs-attr">booking_id</span></span><span>: bookingId })
      })
      .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">resp</span></span></span><span> =&gt; resp.</span><span><span class="hljs-title function_">json</span></span><span>())
      .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">payData</span></span></span><span> =&gt; {
        </span><span><span class="hljs-keyword">if</span></span><span> (payData.</span><span><span class="hljs-property">error</span></span><span>) {
          </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Payment error: "</span></span><span> + payData.</span><span><span class="hljs-property">error</span></span><span>);
        } </span><span><span class="hljs-keyword">else</span></span><span> {
          </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Payment successful! Enjoy your parking."</span></span><span>);
        }
        </span><span><span class="hljs-comment">// Refresh spots availability on map</span></span><span>
        </span><span><span class="hljs-title function_">loadSpots</span></span><span>();
      });
    } </span><span><span class="hljs-keyword">else</span></span><span> {
      </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Booking is reserved. Complete payment from your account when ready."</span></span><span>);
      </span><span><span class="hljs-comment">// Optionally, could keep spot reserved for some time before auto-release</span></span><span>
    }
  });
}

</span><span><span class="hljs-comment">// Handle user logout</span></span><span>
</span><span><span class="hljs-keyword">function</span></span><span> </span><span><span class="hljs-title function_">logout</span></span><span>(</span><span><span class="hljs-params"></span></span><span>) {
  </span><span><span class="hljs-title function_">fetch</span></span><span>(</span><span><span class="hljs-string">'/api/auth/logout'</span></span><span>, { </span><span><span class="hljs-attr">method</span></span><span>: </span><span><span class="hljs-string">'POST'</span></span><span> })
    .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">response</span></span></span><span> =&gt; response.</span><span><span class="hljs-title function_">json</span></span><span>())
    .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">data</span></span></span><span> =&gt; {
      </span><span><span class="hljs-comment">// On successful logout, redirect to login page</span></span><span>
      </span><span><span class="hljs-variable language_">window</span></span><span>.</span><span><span class="hljs-property">location</span></span><span> = </span><span><span class="hljs-string">'/login'</span></span><span>;
    });
}

</span><span><span class="hljs-comment">// Handle destination search</span></span><span>
</span><span><span class="hljs-keyword">function</span></span><span> </span><span><span class="hljs-title function_">searchDestination</span></span><span>(</span><span><span class="hljs-params"></span></span><span>) {
  </span><span><span class="hljs-keyword">const</span></span><span> address = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'destination'</span></span><span>).</span><span><span class="hljs-property">value</span></span><span>;
  </span><span><span class="hljs-keyword">if</span></span><span> (!address) {
    </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Please enter a destination address."</span></span><span>);
    </span><span><span class="hljs-keyword">return</span></span><span>;
  }
  </span><span><span class="hljs-keyword">const</span></span><span> geocoder = </span><span><span class="hljs-keyword">new</span></span><span> google.</span><span><span class="hljs-property">maps</span></span><span>.</span><span><span class="hljs-title class_">Geocoder</span></span><span>();
  geocoder.</span><span><span class="hljs-title function_">geocode</span></span><span>({ </span><span><span class="hljs-attr">address</span></span><span>: address }, </span><span><span class="hljs-function">(<span class="hljs-params">results, status</span></span></span><span>) =&gt; {
    </span><span><span class="hljs-keyword">if</span></span><span> (status === </span><span><span class="hljs-string">"OK"</span></span><span> &amp;&amp; results[</span><span><span class="hljs-number">0</span></span><span>]) {
      </span><span><span class="hljs-keyword">const</span></span><span> loc = results[</span><span><span class="hljs-number">0</span></span><span>].</span><span><span class="hljs-property">geometry</span></span><span>.</span><span><span class="hljs-property">location</span></span><span>;
      map.</span><span><span class="hljs-title function_">setCenter</span></span><span>(loc);
      map.</span><span><span class="hljs-title function_">setZoom</span></span><span>(</span><span><span class="hljs-number">15</span></span><span>);
      </span><span><span class="hljs-comment">// Mark the destination on the map</span></span><span>
      </span><span><span class="hljs-keyword">if</span></span><span> (destMarker) destMarker.</span><span><span class="hljs-title function_">setMap</span></span><span>(</span><span><span class="hljs-literal">null</span></span><span>);
      destMarker = </span><span><span class="hljs-keyword">new</span></span><span> google.</span><span><span class="hljs-property">maps</span></span><span>.</span><span><span class="hljs-title class_">Marker</span></span><span>({
        </span><span><span class="hljs-attr">position</span></span><span>: loc,
        </span><span><span class="hljs-attr">map</span></span><span>: map,
        </span><span><span class="hljs-attr">title</span></span><span>: </span><span><span class="hljs-string">"Destination"</span></span><span>,
        </span><span><span class="hljs-attr">icon</span></span><span>: {
          </span><span><span class="hljs-attr">url</span></span><span>: </span><span><span class="hljs-string">"http://maps.google.com/mapfiles/ms/icons/blue-dot.png"</span></span><span>
        }
      });
      </span><span><span class="hljs-comment">// In a real app, you might filter available spots near this location or show route</span></span><span>
    } </span><span><span class="hljs-keyword">else</span></span><span> {
      </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Geocode was not successful: "</span></span><span> + status);
    }
  });
}

</span><span><span class="hljs-comment">// Setup event handlers on DOM load</span></span><span>
</span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">addEventListener</span></span><span>(</span><span><span class="hljs-string">'DOMContentLoaded'</span></span><span>, </span><span><span class="hljs-function">() =&gt;</span></span><span> {
  </span><span><span class="hljs-comment">// Login form submission</span></span><span>
  </span><span><span class="hljs-keyword">const</span></span><span> loginForm = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'loginForm'</span></span><span>);
  </span><span><span class="hljs-keyword">if</span></span><span> (loginForm) {
    loginForm.</span><span><span class="hljs-title function_">addEventListener</span></span><span>(</span><span><span class="hljs-string">'submit'</span></span><span>, </span><span><span class="hljs-function">(<span class="hljs-params">e</span></span></span><span>) =&gt; {
      e.</span><span><span class="hljs-title function_">preventDefault</span></span><span>();
      </span><span><span class="hljs-keyword">const</span></span><span> email = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'email'</span></span><span>).</span><span><span class="hljs-property">value</span></span><span>;
      </span><span><span class="hljs-keyword">const</span></span><span> password = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'password'</span></span><span>).</span><span><span class="hljs-property">value</span></span><span>;
      </span><span><span class="hljs-title function_">fetch</span></span><span>(</span><span><span class="hljs-string">'/api/auth/login'</span></span><span>, {
        </span><span><span class="hljs-attr">method</span></span><span>: </span><span><span class="hljs-string">'POST'</span></span><span>,
        </span><span><span class="hljs-attr">headers</span></span><span>: { </span><span><span class="hljs-string">'Content-Type'</span></span><span>: </span><span><span class="hljs-string">'application/json'</span></span><span> },
        </span><span><span class="hljs-attr">body</span></span><span>: </span><span><span class="hljs-title class_">JSON</span></span><span>.</span><span><span class="hljs-title function_">stringify</span></span><span>({ </span><span><span class="hljs-attr">email</span></span><span>: email, </span><span><span class="hljs-attr">password</span></span><span>: password })
      })
      .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">response</span></span></span><span> =&gt; response.</span><span><span class="hljs-title function_">json</span></span><span>())
      .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">data</span></span></span><span> =&gt; {
        </span><span><span class="hljs-keyword">if</span></span><span> (data.</span><span><span class="hljs-property">error</span></span><span>) {
          </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'loginError'</span></span><span>).</span><span><span class="hljs-property">innerText</span></span><span> = data.</span><span><span class="hljs-property">error</span></span><span>;
        } </span><span><span class="hljs-keyword">else</span></span><span> {
          </span><span><span class="hljs-comment">// Redirect to main page on success</span></span><span>
          </span><span><span class="hljs-variable language_">window</span></span><span>.</span><span><span class="hljs-property">location</span></span><span> = </span><span><span class="hljs-string">'/'</span></span><span>;
        }
      });
    });
  }
  </span><span><span class="hljs-comment">// Register form submission</span></span><span>
  </span><span><span class="hljs-keyword">const</span></span><span> registerForm = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'registerForm'</span></span><span>);
  </span><span><span class="hljs-keyword">if</span></span><span> (registerForm) {
    registerForm.</span><span><span class="hljs-title function_">addEventListener</span></span><span>(</span><span><span class="hljs-string">'submit'</span></span><span>, </span><span><span class="hljs-function">(<span class="hljs-params">e</span></span></span><span>) =&gt; {
      e.</span><span><span class="hljs-title function_">preventDefault</span></span><span>();
      </span><span><span class="hljs-keyword">const</span></span><span> email = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'regEmail'</span></span><span>).</span><span><span class="hljs-property">value</span></span><span>;
      </span><span><span class="hljs-keyword">const</span></span><span> password = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'regPassword'</span></span><span>).</span><span><span class="hljs-property">value</span></span><span>;
      </span><span><span class="hljs-title function_">fetch</span></span><span>(</span><span><span class="hljs-string">'/api/auth/register'</span></span><span>, {
        </span><span><span class="hljs-attr">method</span></span><span>: </span><span><span class="hljs-string">'POST'</span></span><span>,
        </span><span><span class="hljs-attr">headers</span></span><span>: { </span><span><span class="hljs-string">'Content-Type'</span></span><span>: </span><span><span class="hljs-string">'application/json'</span></span><span> },
        </span><span><span class="hljs-attr">body</span></span><span>: </span><span><span class="hljs-title class_">JSON</span></span><span>.</span><span><span class="hljs-title function_">stringify</span></span><span>({ </span><span><span class="hljs-attr">email</span></span><span>: email, </span><span><span class="hljs-attr">password</span></span><span>: password })
      })
      .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">response</span></span></span><span> =&gt; response.</span><span><span class="hljs-title function_">json</span></span><span>())
      .</span><span><span class="hljs-title function_">then</span></span><span>(</span><span><span class="hljs-function"><span class="hljs-params">data</span></span></span><span> =&gt; {
        </span><span><span class="hljs-keyword">if</span></span><span> (data.</span><span><span class="hljs-property">error</span></span><span>) {
          </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'registerError'</span></span><span>).</span><span><span class="hljs-property">innerText</span></span><span> = data.</span><span><span class="hljs-property">error</span></span><span>;
          </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'registerSuccess'</span></span><span>).</span><span><span class="hljs-property">innerText</span></span><span> = </span><span><span class="hljs-string">""</span></span><span>;
        } </span><span><span class="hljs-keyword">else</span></span><span> {
          </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'registerError'</span></span><span>).</span><span><span class="hljs-property">innerText</span></span><span> = </span><span><span class="hljs-string">""</span></span><span>;
          </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'registerSuccess'</span></span><span>).</span><span><span class="hljs-property">innerText</span></span><span> = </span><span><span class="hljs-string">"Registration successful! Redirecting to login..."</span></span><span>;
          </span><span><span class="hljs-comment">// Redirect to login page after a short delay</span></span><span>
          </span><span><span class="hljs-built_in">setTimeout</span></span><span>(</span><span><span class="hljs-function">() =&gt;</span></span><span> {
            </span><span><span class="hljs-variable language_">window</span></span><span>.</span><span><span class="hljs-property">location</span></span><span> = </span><span><span class="hljs-string">'/login'</span></span><span>;
          }, </span><span><span class="hljs-number">2000</span></span><span>);
        }
      });
    });
  }
  </span><span><span class="hljs-comment">// Logout button</span></span><span>
  </span><span><span class="hljs-keyword">const</span></span><span> logoutBtn = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'logoutBtn'</span></span><span>);
  </span><span><span class="hljs-keyword">if</span></span><span> (logoutBtn) {
    logoutBtn.</span><span><span class="hljs-title function_">addEventListener</span></span><span>(</span><span><span class="hljs-string">'click'</span></span><span>, </span><span><span class="hljs-function">() =&gt;</span></span><span> {
      </span><span><span class="hljs-title function_">logout</span></span><span>();
    });
  }
  </span><span><span class="hljs-comment">// Search button</span></span><span>
  </span><span><span class="hljs-keyword">const</span></span><span> searchBtn = </span><span><span class="hljs-variable language_">document</span></span><span>.</span><span><span class="hljs-title function_">getElementById</span></span><span>(</span><span><span class="hljs-string">'searchBtn'</span></span><span>);
  </span><span><span class="hljs-keyword">if</span></span><span> (searchBtn) {
    searchBtn.</span><span><span class="hljs-title function_">addEventListener</span></span><span>(</span><span><span class="hljs-string">'click'</span></span><span>, </span><span><span class="hljs-function">() =&gt;</span></span><span> {
      </span><span><span class="hljs-title function_">searchDestination</span></span><span>();
    });
  }
});
</span></span></code></div></div></pre>
<h3 data-start="48650" data-end="48681" class=""><code data-start="48654" data-end="48681">frontend/static/style.css</code></h3>
<pre class="overflow-visible!" data-start="48683" data-end="48793"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">css</div><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-css"><span><span><span class="hljs-comment">/* Custom styles for ParkPing */</span></span><span>
</span><span><span class="hljs-selector-id">#map</span></span><span> {
  </span><span><span class="hljs-comment">/* Ensure the map fills its container */</span></span><span>
  </span><span><span class="hljs-attribute">width</span></span><span>: </span><span><span class="hljs-number">100%</span></span><span>;
}
 